<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Valnet Technologies – Cyber Service Request</title>
  <meta name="description" content="Valnet Technologies online request portal – submit cyber services without login." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: {
              50: '#f0f9ff',
              100: '#e0f2fe',
              200: '#bae6fd',
              300: '#7dd3fc',
              400: '#38bdf8',
              500: '#0ea5e9',
              600: '#0284c7',
              700: '#0369a1',
              800: '#075985',
              900: '#0c4a6e',
            },
            secondary: {
              50: '#fdf4ff',
              100: '#fae8ff',
              200: '#f5d0fe',
              300: '#f0abfc',
              400: '#e879f9',
              500: '#d946ef',
              600: '#c026d3',
              700: '#a21caf',
              800: '#86198f',
              900: '#701a75',
            },
            accent: {
              50: '#fffbeb',
              100: '#fef3c7',
              200: '#fde68a',
              300: '#fcd34d',
              400: '#fbbf24',
              500: '#f59e0b',
              600: '#d97706',
              700: '#b45309',
              800: '#92400e',
              900: '#78350f',
            }
          },
          animation: {
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'bounce-slow': 'bounce 2s infinite',
            'float': 'float 6s ease-in-out infinite',
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-10px)' },
            }
          }
        }
      }
    }
  </script>
  <style>
    :root {
      --gradient-start: #4f46e5;
      --gradient-mid: #ec4899;
      --gradient-end: #f59e0b;
    }
    
    html, body {
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      scroll-behavior: smooth;
      overflow-x: hidden;
    }
    
    .glass {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(10px);
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-mid) 50%, var(--gradient-end) 100%);
    }
    
    .gradient-text {
      background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-mid) 50%, var(--gradient-end) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .card-hover {
      transition: all 0.3s ease;
    }
    
    .card-hover:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    
    .service-checkbox:checked + span {
      background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-mid) 100%);
      color: white;
      border-color: transparent;
    }
    
    .service-checkbox:checked + span .service-icon {
      color: white;
    }
    
    .animate-ripple {
      position: relative;
      overflow: hidden;
    }
    
    .animate-ripple:after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 5px;
      height: 5px;
      background: rgba(255, 255, 255, 0.5);
      opacity: 0;
      border-radius: 100%;
      transform: scale(1, 1) translate(-50%);
      transform-origin: 50% 50%;
    }
    
    .animate-ripple:focus:not(:active)::after {
      animation: ripple 1s ease-out;
    }
    
    @keyframes ripple {
      0% {
        transform: scale(0, 0);
        opacity: 0.5;
      }
      20% {
        transform: scale(50, 50);
        opacity: 0.3;
      }
      100% {
        transform: scale(100, 100);
        opacity: 0;
      }
    }
    
    .particles-container {
      position: relative;
      overflow: hidden;
    }
    
    .particle {
      position: absolute;
      border-radius: 50%;
      opacity: 0.3;
      z-index: 0;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
      background: linear-gradient(to bottom, var(--gradient-start), var(--gradient-mid));
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(to bottom, var(--gradient-mid), var(--gradient-end));
    }

    /* Service icons */
    .service-icon {
      font-size: 1.25rem;
      color: #4f46e5;
      transition: all 0.3s ease;
    }

    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .mobile-stack {
        flex-direction: column;
      }
      
      .mobile-full {
        width: 100%;
      }
      
      .mobile-padding {
        padding: 1.5rem;
      }
      
      .mobile-text-center {
        text-align: center;
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 0.5rem;
      }
      
      .stats-grid > div:last-child {
        grid-column: span 2;
      }
      
      .service-option {
        flex-direction: column;
        text-align: center;
        padding: 0.75rem;
      }
      
      .service-option .service-icon {
        margin-right: 0;
        margin-bottom: 0.5rem;
      }
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 text-slate-800 particles-container">
  <!-- Animated background particles -->
  <div id="particles"></div>
  
  <!-- HEADER / NAV -->
  <header class="sticky top-0 z-30 border-b bg-white/80 backdrop-blur shadow-sm">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-4">
      <div class="flex items-center gap-3">
        <div class="h-12 w-12 rounded-2xl gradient-bg text-white grid place-items-center font-black text-xl shadow-md">
          <i class="fa-solid fa-print"></i>
        </div>
        <div>
          <h1 class="text-xl font-bold tracking-tight gradient-text">Valnet Technologies</h1>
          <p class="text-xs text-slate-500 -mt-0.5">Cyber Service Request Portal</p>
        </div>
      </div>
      <nav class="ml-auto flex items-center gap-2">
        <button id="tab-form" class="tab-btn px-4 py-2 rounded-xl text-sm font-semibold transition-all duration-300 hover:bg-primary-50 hover:text-primary-700 focus:outline-none data-[active=true]:gradient-bg data-[active=true]:text-white data-[active=true]:shadow-md flex items-center gap-1">
          <i class="fa-solid fa-pen-to-square text-xs"></i> <span class="hidden sm:inline">Request Form</span>
        </button>
        <button id="tab-admin" class="tab-btn px-4 py-2 rounded-xl text-sm font-semibold transition-all duration-300 hover:bg-primary-50 hover:text-primary-700 focus:outline-none data-[active=true]:gradient-bg data-[active=true]:text-white data-[active=true]:shadow-md flex items-center gap-1" title="No login required (read-only unless you change status)">
          <i class="fa-solid fa-chart-line text-xs"></i> <span class="hidden sm:inline">Dashboard</span>
        </button>
      </nav>
    </div>
  </header>

  <!-- MAIN -->
  <main class="max-w-7xl mx-auto px-4 py-8 relative z-10">

    <!-- HERO -->
    <section class="mb-8">
      <div class="glass rounded-3xl p-6 md:p-8 shadow-sm border-0 gradient-bg text-white overflow-hidden relative">
        <div class="absolute inset-0 bg-black/10"></div>
        <div class="relative z-10 grid md:grid-cols-2 gap-6">
          <div>
            <h2 class="text-2xl md:text-3xl font-bold">Fast, Modern & Paperless</h2>
            <p class="mt-2 text-white/90">Welcome to Valnet Technologies online request portal. Submit your request for <span class="font-medium">Document Printing, Photocopying, Scanning, Typing, KRA, HELB</span> and more. We'll contact you for confirmation and pickup/delivery.</p>
            <ul class="mt-4 text-sm text-white/90 list-disc pl-5 space-y-1">
              <li>No login required</li>
              <li>Secure uploads via Firebase Storage</li>
              <li>Real-time tracking in the Dashboard</li>
            </ul>
            <button id="scroll-to-form" class="mt-6 px-4 py-2 bg-white text-primary-700 rounded-xl font-semibold text-sm flex items-center gap-2 shadow-md hover:shadow-lg transition-all">
              <i class="fa-solid fa-arrow-down"></i> Request Service Now
            </button>
          </div>
          <div class="rounded-2xl p-4 bg-white/20 border border-white/30 shadow-sm grid place-items-center backdrop-blur-sm">
            <div class="w-full">
              <dl class="grid stats-grid grid-cols-3 gap-4 text-center">
                <div class="p-4 rounded-xl bg-white/10 backdrop-blur-sm">
                  <dt class="text-xs text-white/80">Avg. Response</dt>
                  <dd class="text-xl font-bold text-white">&lt; 1 hr</dd>
                </div>
                <div class="p-4 rounded-xl bg-white/10 backdrop-blur-sm">
                  <dt class="text-xs text-white/80">Requests</dt>
                  <dd id="stat-requests" class="text-xl font-bold text-white animate-pulse-slow">0</dd>
                </div>
                <div class="p-4 rounded-xl bg-white/10 backdrop-blur-sm">
                  <dt class="text-xs text-white/80">Completed</dt>
                  <dd id="stat-completed" class="text-xl font-bold text-white animate-pulse-slow">0</dd>
                </div>
              </dl>
              <p class="mt-3 text-xs text-white/70">Stats update live from Firebase.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- TABS CONTENT -->
    <section id="panel-form" class="tab-panel">
      <!-- FORM CARD -->
      <div class="bg-white rounded-3xl shadow-lg border-0 overflow-hidden card-hover">
        <div class="px-6 md:px-8 py-6 gradient-bg text-white">
          <h3 class="text-lg md:text-xl font-semibold flex items-center gap-2">
            <i class="fa-solid fa-pen-circle"></i> Service Request Form
          </h3>
          <p class="text-sm text-white/90">Please fill in the details below. Fields marked * are required.</p>
        </div>

        <form id="serviceForm" class="p-6 md:p-8 grid gap-6 bg-gradient-to-br from-white to-slate-50">
          <!-- Section: Customer Details -->
          <div class="bg-primary-50 p-5 rounded-2xl">
            <h4 class="text-base font-semibold text-primary-900 flex items-center gap-2">
              <i class="fa-solid fa-user text-primary-600"></i> Customer Details
            </h4>
            <div class="mt-3 grid md:grid-cols-3 gap-4 mobile-stack">
              <div class="mobile-full">
                <label class="text-sm font-medium text-slate-700">Full Name *</label>
                <input id="name" type="text" required class="mt-1 w-full border border-slate-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all" placeholder="e.g. Jane Doe" />
              </div>
              <div class="mobile-full">
                <label class="text-sm font-medium text-slate-700">Phone Number *</label>
                <input id="phone" type="tel" required pattern="^(?:0|\+?254)\d{9}$" class="mt-1 w-full border border-slate-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all" placeholder="e.g. 07XXXXXXXX or +2547XXXXXXX" />
                <p class="text-xs text-slate-500 mt-1">Kenya format supported: 07..., 01..., or +2547...</p>
              </div>
              <div class="mobile-full">
                <label class="text-sm font-medium text-slate-700">Email Address</label>
                <input id="email" type="email" class="mt-1 w-full border border-slate-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all" placeholder="optional" />
              </div>
            </div>
          </div>

          <!-- Section: Service Request -->
          <div class="bg-secondary-50 p-5 rounded-2xl">
            <h4 class="text-base font-semibold text-secondary-900 flex items-center gap-2">
              <i class="fa-solid fa-list-check text-secondary-600"></i> Service Request *
            </h4>
            <div class="mt-3 grid md:grid-cols-3 gap-3">
              <label class="flex items-center gap-2 cursor-pointer service-option">
                <input type="checkbox" class="svc service-checkbox hidden" value="Document Printing">
                <span class="px-4 py-2 border border-slate-300 rounded-xl text-sm transition-all hover:shadow-md flex items-center">
                  <i class="fa-solid fa-print service-icon mr-2"></i> Document Printing
                </span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer service-option">
                <input type="checkbox" class="svc service-checkbox hidden" value="Photocopying">
                <span class="px-4 py-2 border border-slate-300 rounded-xl text-sm transition-all hover:shadow-md flex items-center">
                  <i class="fa-solid fa-copy service-icon mr-2"></i> Photocopying
                </span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer service-option">
                <input type="checkbox" class="svc service-checkbox hidden" value="Scanning">
                <span class="px-4 py-2 border border-slate-300 rounded-xl text-sm transition-all hover:shadow-md flex items-center">
                  <i class="fa-solid fa-scanner service-icon mr-2"></i> Scanning
                </span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer service-option">
                <input type="checkbox" class="svc service-checkbox hidden" value="Typing & Editing">
                <span class="px-4 py-2 border border-slate-300 rounded-xl text-sm transition-all hover:shadow-md flex items-center">
                  <i class="fa-solid fa-keyboard service-icon mr-2"></i> Typing & Editing
                </span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer service-option">
                <input type="checkbox" class="svc service-checkbox hidden" value="KRA PIN Services">
                <span class="px-4 py-2 border border-slate-300 rounded-xl text-sm transition-all hover:shadow-md flex items-center">
                  <i class="fa-solid fa-landmark service-icon mr-2"></i> KRA PIN Services
                </span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer service-option">
                <input type="checkbox" class="svc service-checkbox hidden" value="HELB Application/Inquiry">
                <span class="px-4 py-2 border border-slate-300 rounded-xl text-sm transition-all hover:shadow-md flex items-center">
                  <i class="fa-solid fa-graduation-cap service-icon mr-2"></i> HELB Application
                </span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer service-option">
                <input type="checkbox" class="svc service-checkbox hidden" value="CV Writing & Job Application">
                <span class="px-4 py-2 border border-slate-300 rounded-xl text-sm transition-all hover:shadow-md flex items-center">
                  <i class="fa-solid fa-file-alt service-icon mr-2"></i> CV Writing
                </span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer service-option">
                <input type="checkbox" class="svc service-checkbox hidden" value="Passport Application Support">
                <span class="px-4 py-2 border border-slate-300 rounded-xl text-sm transition-all hover:shadow-md flex items-center">
                  <i class="fa-solid fa-passport service-icon mr-2"></i> Passport Application
                </span>
              </label>
            </div>
            <div class="mt-4 grid md:grid-cols-2 gap-4 mobile-stack">
              <div class="mobile-full">
                <label class="text-sm font-medium text-slate-700">Other Service</label>
                <input id="otherService" type="text" class="mt-1 w-full border border-slate-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all" placeholder="Other (please specify)" />
              </div>
              <div class="mobile-full">
                <label class="text-sm font-medium text-slate-700">File Upload</label>
                <div class="relative mt-1">
                  <input id="fileUpload" type="file" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" class="w-full border border-slate-300 rounded-xl px-4 py-3 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100 cursor-pointer" />
                </div>
              </div>
            </div>
            <p class="text-xs text-slate-500 mt-2">If you select Printing/Photocopying/Scanning, a file upload is required (PDF/Word/Images).</p>
            <div class="mt-4">
              <label class="text-sm font-medium text-slate-700">Additional Instructions</label>
              <textarea id="instructions" rows="3" class="mt-1 w-full border border-slate-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all" placeholder="Additional Instructions (optional)"></textarea>
            </div>
          </div>

          <!-- Section: Delivery & Payment -->
          <div class="bg-accent-50 p-5 rounded-2xl">
            <h4 class="text-base font-semibold text-accent-900 flex items-center gap-2">
              <i class="fa-solid fa-truck-fast text-accent-600"></i> Delivery & Payment *
            </h4>
            <div class="mt-3 grid md:grid-cols-2 gap-4 mobile-stack">
              <div class="mobile-full">
                <label class="text-sm font-medium text-slate-700">How would you like to receive your document/service?</label>
                <select id="delivery" required class="mt-1 w-full border border-slate-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all appearance-none bg-[url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"6 9 12 15 18 9\"></polyline></svg>')] bg-no-repeat bg-[length:20px] bg-[center_right_1rem]">
                  <option value="">Select</option>
                  <option>Pick up at Cyber (Valnet Technologies)</option>
                  <option>Send via Email</option>
                  <option>Send via WhatsApp</option>
                </select>
              </div>
              <div class="mobile-full">
                <label class="text-sm font-medium text-slate-700">Preferred Payment Method</label>
                <select id="payment" required class="mt-1 w-full border border-slate-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all appearance-none bg-[url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"6 9 12 15 18 9\"></polyline></svg>')] bg-no-repeat bg-[length:20px] bg-[center_right_1rem]">
                  <option value="">Select</option>
                  <option>Pay on Collection</option>
                  <option>Mpesa (Till/Paybill)</option>
                </select>
                <p class="text-xs text-slate-500 mt-1">Mpesa: <span class="font-medium">Till 123456 • Name: Valnet Technologies</span></p>
              </div>
            </div>
          </div>

          <!-- Section: Confirmation -->
          <div class="bg-slate-100 p-5 rounded-2xl">
            <h4 class="text-base font-semibold text-slate-900 flex items-center gap-2">
              <i class="fa-solid fa-clipboard-check text-slate-600"></i> Confirmation *
            </h4>
            <div class="mt-3 grid md:grid-cols-3 gap-4 mobile-stack">
              <div class="mobile-full">
                <label class="text-sm font-medium text-slate-700">Expected Time of Delivery/Collection</label>
                <select id="deliveryTime" required class="mt-1 w-full border border-slate-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all appearance-none bg-[url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"6 9 12 15 18 9\"></polyline></svg>')] bg-no-repeat bg-[length:20px] bg-[center_right_1rem]">
                  <option value="">Select</option>
                  <option>Within 1 Hour</option>
                  <option>Same Day</option>
                  <option>Next Day</option>
                </select>
              </div>
              <label class="flex items-start gap-3 col-span-2 mt-1 p-4 bg-white rounded-xl border border-slate-300 mobile-full">
                <input id="agree" type="checkbox" required class="mt-1 h-5 w-5 text-primary-600 rounded focus:ring-primary-500"> 
                <span class="text-sm text-slate-700">I confirm that the information provided is accurate and agree to Valnet Technologies' service terms.</span>
              </label>
            </div>
          </div>

          <!-- Submit -->
          <div class="flex items-center gap-3 mobile-stack mobile-text-center">
            <button id="submitBtn" type="submit" class="animate-ripple inline-flex items-center justify-center gap-2 gradient-bg hover:shadow-lg text-white px-6 py-4 rounded-2xl font-semibold shadow-md transition-all duration-300 disabled:opacity-60 mobile-full">
              <i class="fa-solid fa-paper-plane"></i>
              Submit Request
            </button>
            <span id="formMsg" class="text-sm mobile-full"></span>
          </div>
        </form>
      </div>
    </section>

    <!-- ADMIN DASHBOARD -->
    <section id="panel-admin" class="tab-panel hidden">
      <div class="bg-white rounded-3xl shadow-lg border-0 overflow-hidden card-hover">
        <div class="px-6 md:px-8 py-6 gradient-bg text-white flex flex-wrap gap-3 items-center mobile-stack">
          <div class="mobile-full mobile-text-center md:text-left">
            <h3 class="text-lg md:text-xl font-semibold flex items-center gap-2 justify-center md:justify-start">
              <i class="fa-solid fa-chart-simple"></i> Admin Dashboard
            </h3>
            <p class="text-sm text-white/90">Monitor incoming requests (live). Update status, filter and export to CSV. No login required.</p>
          </div>
          <div class="ml-auto flex items-center gap-2 mobile-full justify-center md:justify-end flex-wrap">
            <div class="relative mobile-full sm:mobile-auto mb-2 sm:mb-0">
              <i class="fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"></i>
              <input id="search" class="pl-10 pr-4 py-2 border rounded-xl text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none mobile-full" placeholder="Search name/phone/service..." />
            </div>
            <select id="filterStatus" class="border rounded-xl px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none appearance-none bg-[url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"6 9 12 15 18 9\"></polyline></svg>')] bg-no-repeat bg-[length:20px] bg-[center_right_0.5rem] pr-8 mobile-full sm:mobile-auto mb-2 sm:mb-0">
              <option value="">All Status</option>
              <option>New</option>
              <option>In Progress</option>
              <option>Completed</option>
            </select>
            <button id="btnExport" class="px-4 py-2 rounded-xl border border-white/30 bg-white/10 text-white text-sm hover:bg-white/20 transition-all flex items-center gap-2 backdrop-blur-sm mobile-full sm:mobile-auto">
              <i class="fa-solid fa-file-export"></i> Export CSV
            </button>
          </div>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm">
            <thead class="bg-slate-100">
              <tr class="text-left">
                <th class="px-4 py-3 font-semibold text-slate-700">Time</th>
                <th class="px-4 py-3 font-semibold text-slate-700">Name</th>
                <th class="px-4 py-3 font-semibold text-slate-700">Phone</th>
                <th class="px-4 py-3 font-semibold text-slate-700">Services</th>
                <th class="px-4 py-3 font-semibold text-slate-700">Delivery</th>
                <th class="px-4 py-3 font-semibold text-slate-700">Payment</th>
                <th class="px-4 py-3 font-semibold text-slate-700">File</th>
                <th class="px-4 py-3 font-semibold text-slate-700">Status</th>
                <th class="px-4 py-3 font-semibold text-slate-700">Actions</th>
              </tr>
            </thead>
            <tbody id="tbody" class="divide-y divide-slate-200"></tbody>
          </table>
        </div>
      </div>
      <p class="mt-3 text-xs text-slate-500">Tip: Bookmark this page on shop PCs. Anyone with the link can view, so avoid sharing publicly.</p>
    </section>

  </main>

  <!-- TOAST -->
  <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 hidden z-50">
    <div class="bg-slate-900 text-white px-4 py-3 rounded-full text-sm shadow-lg flex items-center gap-2">
      <i class="fa-solid fa-circle-check text-green-400"></i>
      <span class="toast-message"></span>
    </div>
  </div>

  <!-- FIREBASE & APP LOGIC -->
  <script type="module">
    // Firebase v10+ CDN imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";
    import { getDatabase, ref, push, set, serverTimestamp, onValue, update } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";
    import { getStorage, ref as sRef, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

    // 🔥 YOUR FIREBASE CONFIG (as provided)
    const firebaseConfig = {
      apiKey: "AIzaSyCSv-qp0XaFPeN3zpOyuKHAiILDIlCQ0Dc",
      authDomain: "school-281ff.firebaseapp.com",
      databaseURL: "https://school-281ff-default-rtdb.firebaseio.com",
      projectId: "school-281ff",
      storageBucket: "school-281ff.appspot.com",
      messagingSenderId: "623145317447",
      appId: "1:623145317447:web:edefdbb896625317196d62",
      measurementId: "G-JBJV9K0890"
    };

    const app = initializeApp(firebaseConfig);
    try { getAnalytics(app); } catch (e) { /* analytics optional on non-https */ }
    const db = getDatabase(app);
    const storage = getStorage(app);

    // UI helpers
    const $ = (q) => document.querySelector(q);
    const $$ = (q) => Array.from(document.querySelectorAll(q));
    const toast = (msg) => { 
      const t = document.getElementById('toast'); 
      t.querySelector('.toast-message').textContent = msg; 
      t.classList.remove('hidden'); 
      setTimeout(()=>t.classList.add('hidden'), 2200); 
    };

    // Create animated particles
    function createParticles() {
      const container = document.getElementById('particles');
      const particleCount = 20;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        
        // Random properties
        const size = Math.random() * 20 + 5;
        const posX = Math.random() * 100;
        const posY = Math.random() * 100;
        const delay = Math.random() * 5;
        const duration = Math.random() * 10 + 10;
        const colors = [
          'rgba(79, 70, 229, 0.2)', 
          'rgba(236, 72, 153, 0.2)', 
          'rgba(245, 158, 11, 0.2)'
        ];
        const color = colors[Math.floor(Math.random() * colors.length)];
        
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        particle.style.left = `${posX}%`;
        particle.style.top = `${posY}%`;
        particle.style.background = color;
        particle.style.animation = `float ${duration}s ease-in-out ${delay}s infinite`;
        
        container.appendChild(particle);
      }
    }
    
    createParticles();

    // Tabs
    const setTab = (key) => {
      $$('#panel-form, #panel-admin').forEach(el=>el.classList.add('hidden'));
      $$('#tab-form, #tab-admin').forEach(el=>el.dataset.active = 'false');
      if (key === 'admin') { 
        $('#panel-admin').classList.remove('hidden'); 
        $('#tab-admin').dataset.active = 'true'; 
      } else { 
        $('#panel-form').classList.remove('hidden'); 
        $('#tab-form').dataset.active = 'true'; 
      }
      localStorage.setItem('valnet_tab', key);
    };
    
    $('#tab-form').addEventListener('click', ()=>setTab('form'));
    $('#tab-admin').addEventListener('click', ()=>setTab('admin'));
    setTab(localStorage.getItem('valnet_tab') || 'form');
    
    // Scroll to form
    $('#scroll-to-form').addEventListener('click', () => {
      document.getElementById('panel-form').scrollIntoView({ behavior: 'smooth' });
    });

    // Form logic
    const form = document.getElementById('serviceForm');
    const submitBtn = document.getElementById('submitBtn');
    const formMsg = document.getElementById('formMsg');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      formMsg.textContent = '';

      // Collect values
      const name = $('#name').value.trim();
      const phone = $('#phone').value.trim();
      const email = $('#email').value.trim();
      const delivery = $('#delivery').value;
      const payment = $('#payment').value;
      const deliveryTime = $('#deliveryTime').value;
      const instructions = $('#instructions').value.trim();
      const otherService = $('#otherService').value.trim();
      const checked = $$('.svc:checked').map(cb=>cb.value);

      // Basic validation
      if (!checked.length && !otherService) {
        toast('Select at least one service or specify Other.');
        return;
      }

      const file = document.getElementById('fileUpload').files[0];
      const needsFile = checked.some(v=>['Document Printing','Photocopying','Scanning'].includes(v));
      if (needsFile && !file) {
        toast('File required for Printing/Photocopying/Scanning.');
        return;
      }

      // Disable submit
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<i class="fa-solid fa-circle-notch animate-spin"></i> Submitting...';

      try {
        // Create DB key first
        const reqRef = push(ref(db, 'requests'));
        const id = reqRef.key;

        // Upload file if any
        let fileMeta = null;
        if (file) {
          const path = `requests/${id}/${Date.now()}_${file.name}`;
          const storageReference = sRef(storage, path);
          await uploadBytes(storageReference, file);
          const url = await getDownloadURL(storageReference);
          fileMeta = { path, name: file.name, url, size: file.size, type: file.type };
        }

        const record = {
          name, phone, email,
          services: otherService ? [...checked, otherService] : checked,
          delivery, payment, deliveryTime, instructions,
          file: fileMeta,
          status: 'New',
          createdAt: { '.sv': 'timestamp' }, // server timestamp
          readableTime: new Date().toISOString()
        };

        await set(reqRef, record);

        form.reset();
        toast('Request submitted successfully');
        formMsg.textContent = '✅ Your request has been submitted. We will contact you shortly.';
        formMsg.className = 'text-sm text-green-700';
      } catch (err) {
        console.error(err);
        formMsg.textContent = '❌ Submission failed. Please try again.';
        formMsg.className = 'text-sm text-red-600';
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<i class="fa-solid fa-paper-plane"></i> Submit Request';
      }
    });

    // DASHBOARD: live table
    const tbody = document.getElementById('tbody');
    const search = document.getElementById('search');
    const filterStatus = document.getElementById('filterStatus');
    const btnExport = document.getElementById('btnExport');

    let cache = {};

    const render = () => {
      const term = search.value.toLowerCase();
      const statusFilter = filterStatus.value;
      const rows = Object.entries(cache)
        .sort((a,b)=> (b[1]?.createdAt||0) - (a[1]?.createdAt||0))
        .filter(([id, r]) => {
          const hay = `${r.name} ${r.phone} ${r.email||''} ${(r.services||[]).join(' ')}`.toLowerCase();
          const okTerm = !term || hay.includes(term);
          const okStatus = !statusFilter || r.status === statusFilter;
          return okTerm && okStatus;
        })
        .map(([id, r]) => {
          const time = r.createdAt ? new Date(r.createdAt).toLocaleString() : r.readableTime || '';
          const statusColors = {
            'New': 'bg-blue-100 text-blue-800',
            'In Progress': 'bg-yellow-100 text-yellow-800',
            'Completed': 'bg-green-100 text-green-800'
          };
          return `
            <tr class="hover:bg-slate-50 transition-colors">
              <td class="px-4 py-3 whitespace-nowrap">${time}</td>
              <td class="px-4 py-3 font-medium">${escapeHtml(r.name)}</td>
              <td class="px-4 py-3">${escapeHtml(r.phone)}</td>
              <td class="px-4 py-3">${(r.services||[]).map(escapeHtml).join(', ')}</td>
              <td class="px-4 py-3">${escapeHtml(r.delivery||'')}</td>
              <td class="px-4 py-3">${escapeHtml(r.payment||'')}</td>
              <td class="px-4 py-3">${r.file?.url ? `<a class="text-primary-600 underline hover:text-primary-700 transition-colors" href="${r.file.url}" target="_blank"><i class="fa-solid fa-download mr-1"></i> Download</a>` : '<span class="text-slate-400">—</span>'}</td>
              <td class="px-4 py-3">
                <select data-id="${id}" class="statusSel border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all ${statusColors[r.status] || ''}">
                  ${['New','In Progress','Completed'].map(s=>`<option ${r.status===s?'selected':''} class="${statusColors[s] || ''}">${s}</option>`).join('')}
                </select>
              </td>
              <td class="px-4 py-3">
                <button data-id="${id}" class="btnCopy px-3 py-2 text-sm rounded-lg border border-slate-300 hover:bg-slate-100 transition-colors flex items-center gap-1">
                  <i class="fa-solid fa-copy text-slate-600"></i> Copy
                </button>
              </td>
            </tr>`;
        }).join('');
      tbody.innerHTML = rows || '<tr><td class="px-4 py-6 text-center text-slate-500" colspan="9">No requests yet.</td></tr>';

      // Stats
      const all = Object.values(cache);
      const completed = all.filter(r=>r.status==='Completed').length;
      document.getElementById('stat-requests').textContent = all.length;
      document.getElementById('stat-completed').textContent = completed;
    };

    onValue(ref(db, 'requests'), (snap) => {
      cache = snap.val() || {};
      render();
    });

    // Update status
    tbody.addEventListener('change', async (e) => {
      const sel = e.target.closest('.statusSel');
      if (!sel) return;
      const id = sel.dataset.id; const status = sel.value;
      await update(ref(db, `requests/${id}`), { status });
      toast('Status updated');
    });

    // Copy phone
    tbody.addEventListener('click', async (e) => {
      const btn = e.target.closest('.btnCopy');
      if (!btn) return;
      const id = btn.dataset.id; const r = cache[id];
      try { 
        await navigator.clipboard.writeText(r.phone||''); 
        toast('Phone number copied to clipboard');
      } catch { 
        toast('Copy failed'); 
      }
    });

    // Export CSV
    btnExport.addEventListener('click', () => {
      const rows = [['Time','Name','Phone','Email','Services','Delivery','Payment','Expected','Status','FileURL']];
      Object.entries(cache).forEach(([id, r]) => {
        const time = r.createdAt ? new Date(r.createdAt).toISOString() : '';
        rows.push([
          time, r.name||'', r.phone||'', r.email||'', (r.services||[]).join('; '), r.delivery||'', r.payment||'', r.deliveryTime||'', r.status||'', r.file?.url||''
        ]);
      });
      const csv = rows.map(r=>r.map(csvEscape).join(',')).join('\n');
      const blob = new Blob([csv], {type:'text/csv'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'valnet_requests.csv'; a.click();
      URL.revokeObjectURL(url);
      toast('CSV export started');
    });

    // Utils
    function escapeHtml(s=''){ return String(s).replace(/[&<>"']/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m])); }
    function csvEscape(s=''){ const t = String(s).replace(/"/g,'""'); return /[",\n]/.test(t) ? `"${t}"` : t; }
  </script>

  <!-- FOOTER -->
  <footer class="max-w-7xl mx-auto px-4 pb-10 pt-6 text-center text-xs text-slate-500">
    © <span id="year"></span> Valnet Technologies. Built with Firebase. <span class="block sm:inline">Update Mpesa details and logo in this file.</span>
  </footer>
  <script>document.getElementById('year').textContent = new Date().getFullYear();</script>
</body>
</html>